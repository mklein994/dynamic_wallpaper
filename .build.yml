image: archlinux
sources:
  - https://github.com/mklein994/dynamic_wallpaper
environment:
  PROJECT_PATH: "dynamic_wallpaper"
tasks:
  - rustup: |
      curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | \
        sh -s -- -y --profile minimal --component rustfmt
      cat ~/.cargo/env >> ~/.buildenv
  - stable: |
      cd $PROJECT_PATH
      cargo fmt -- --check
      cargo build --verbose
      cargo test --verbose
      cargo doc --no-deps --verbose
  - nightly: |
      cd $PROJECT_PATH
      rustup toolchain install nightly
      cargo +nightly build --verbose ||:
      cargo +nightly test --verbose ||:
      cargo +nightly doc --no-deps --verbose ||:
